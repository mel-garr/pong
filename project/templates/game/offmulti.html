<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multiplayer Game</title>
    <style>
        #gamecanvas{
            height : 600px;
            width : 800px;
            border : 1px black solid;
            background-color: grey;
        }

    </style>
</head>
<body>
    <h1>Welcome to the game room: {{ room_id }}</h1>
    <p>Room ID: {{ room_id}}</p>

    <input type="text" id="messageInput" placeholder="Type a message" />
    <button onclick="sendMessage()">Send Message</button>


    <canvas id="gamecanvas" ></canvas>

    <script type="text/javascript">
        const canvas = document.querySelector('#gamecanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = 800;
        canvas.height = 600;

        const sockett = new WebSocket(`ws://${window.location.host}/ws/offgame/{{room_id}}/`);
        // Handle incoming messages
        sockett.onmessage = function(event) {
            const data = JSON.parse(event.data);
            console.log("Message from server:", data);
        };
        
        // When the WebSockett connection is opened
        sockett.onopen = function(event) {
            console.log("WebSockett is open now.");
            // Optionally, you can send a message to the server to initialize game state
            sockett.send(JSON.stringify({ 'message': 'Player connected!' }));
        };

        // When the WebSockett connection is closed
        sockett.onclose = function(event) {
            console.log("WebSockett is closed.");
        };

        // Handle errors
        sockett.onerror = function(error) {
            console.error("WebSockett error observed:", error);
        };

        // Function to send messages to the server
        function sendMessage() {
            const message = document.getElementById("messageInput").value;
            sockett.send(JSON.stringify({ 'message': message }));
        }
        // ctx.fillStyle = "red";
        // ctx.fillRect(0, 0, 300, 400);

        </script>
<!-- // You can handle the game state update here
// update_game(data);
// function update_game(data){
//     ctx.clearRect(0, 0, canvas.width , canvas.height);
//     // console.log(data.name);
// } -->
</body>
</html>